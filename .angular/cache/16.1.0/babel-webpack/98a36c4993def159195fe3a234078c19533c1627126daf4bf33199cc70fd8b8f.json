{"ast":null,"code":"import { environment } from 'src/environments/environment';\nimport * as CryptoJS from 'crypto-js';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nclass PaymentConfirmComponent {\n  constructor(formBuilder) {\n    this.formBuilder = formBuilder;\n    this.paymentForm = document.getElementById('payment_form');\n    this.accessKey = 'c66502af927a3533bfa6d215394eda4c';\n    this.profileId = 'B63C4A44-D1AE-4F14-B0D5-4FFC7813736F';\n    this.transactionUuid = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);\n    this.signedFieldNames = 'access_key,profile_id,transaction_uuid,signed_field_names,unsigned_field_names,signed_date_time,locale,transaction_type,reference_number,amount,currency';\n    this.signedDateTime = new Date();\n    this.locale = 'en-US';\n    this.checkoutForm = this.formBuilder.group({\n      accessKey: 'c66502af927a3533bfa6d215394eda4c',\n      profileId: 'B63C4A44-D1AE-4F14-B0D5-4FFC7813736F',\n      transactionUuid: Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15),\n      signedFieldNames: 'access_key,profile_id,transaction_uuid,signed_field_names,unsigned_field_names,signed_date_time,locale,transaction_type,reference_number,amount,currency',\n      signedDateTime: new Date(),\n      locale: 'en-US',\n      transaction_type: 'authorization',\n      amount: '25',\n      reference_number: '123456789'\n    });\n  }\n  onSubmit() {\n    console.warn('Your order has been submitted', this.checkoutForm.value);\n    this.checkoutForm.reset();\n  }\n  sign(params) {\n    console.log(params);\n    return this.signData(this.buildDataToSign(params), environment.SECRET_KEY);\n  }\n  signData(data, secretKey) {\n    const signature = CryptoJS.HmacSHA256(environment.HMAC_SHA256, secretKey);\n    const signatureBase = signature.toString(CryptoJS.enc.Base64);\n    console.log(signatureBase);\n    return signatureBase;\n  }\n  buildDataToSign(params) {\n    const signedFieldNames = params.signed_field_names.split(',');\n    const dataToSign = signedFieldNames.map(field => `${field}=${params[field]}`);\n    console.log('!!!!!!!!!!!');\n    console.log(this.commaSeparate(dataToSign));\n    return this.commaSeparate(dataToSign);\n  }\n  commaSeparate(dataToSign) {\n    return dataToSign.join(',');\n  }\n}\nPaymentConfirmComponent.ɵfac = function PaymentConfirmComponent_Factory(t) {\n  return new (t || PaymentConfirmComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder));\n};\nPaymentConfirmComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: PaymentConfirmComponent,\n  selectors: [[\"app-payment-confirm\"]],\n  decls: 24,\n  vars: 1,\n  consts: [[3, \"formGroup\", \"ngSubmit\"], [\"type\", \"hidden\", \"formControlName\", \"access_key\"], [\"type\", \"hidden\", \"formControlName\", \"profile_id\"], [\"type\", \"hidden\", \"formControlName\", \"transaction_uuid\"], [\"type\", \"hidden\", \"formControlName\", \"signed_field_names\"], [\"type\", \"hidden\", \"formControlName\", \"unsigned_field_names\", \"value\", \"\"], [\"type\", \"hidden\", \"formControlName\", \"signed_date_time\"], [\"type\", \"hidden\", \"formControlName\", \"locale\"], [\"for\", \"transaction_type\"], [\"id\", \"transaction_type\", \"type\", \"text\", \"formControlName\", \"transaction_type\"], [\"for\", \"amount\"], [\"id\", \"amount\", \"type\", \"text\", \"formControlName\", \"amount\"], [\"for\", \"reference_number\"], [\"id\", \"reference_number\", \"type\", \"text\", \"formControlName\", \"reference_number\"], [\"type\", \"submit\", 1, \"button\"]],\n  template: function PaymentConfirmComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"p\");\n      i0.ɵɵtext(1, \"Payment Details\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(2, \"form\", 0);\n      i0.ɵɵlistener(\"ngSubmit\", function PaymentConfirmComponent_Template_form_ngSubmit_2_listener() {\n        return ctx.onSubmit();\n      });\n      i0.ɵɵelement(3, \"input\", 1)(4, \"input\", 2)(5, \"input\", 3)(6, \"input\", 4)(7, \"input\", 5)(8, \"input\", 6)(9, \"input\", 7);\n      i0.ɵɵelementStart(10, \"div\")(11, \"label\", 8);\n      i0.ɵɵtext(12, \" transaction_type \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(13, \"input\", 9);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(14, \"div\")(15, \"label\", 10);\n      i0.ɵɵtext(16, \" amount \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(17, \"input\", 11);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(18, \"div\")(19, \"label\", 12);\n      i0.ɵɵtext(20, \" reference_number \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(21, \"input\", 13);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(22, \"button\", 14);\n      i0.ɵɵtext(23, \"Purchase\");\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"formGroup\", ctx.checkoutForm);\n    }\n  },\n  dependencies: [i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName],\n  styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});\nexport { PaymentConfirmComponent };","map":{"version":3,"names":["environment","CryptoJS","PaymentConfirmComponent","constructor","formBuilder","paymentForm","document","getElementById","accessKey","profileId","transactionUuid","Math","random","toString","substring","signedFieldNames","signedDateTime","Date","locale","checkoutForm","group","transaction_type","amount","reference_number","onSubmit","console","warn","value","reset","sign","params","log","signData","buildDataToSign","SECRET_KEY","data","secretKey","signature","HmacSHA256","HMAC_SHA256","signatureBase","enc","Base64","signed_field_names","split","dataToSign","map","field","commaSeparate","join","i0","ɵɵdirectiveInject","i1","FormBuilder","selectors","decls","vars","consts","template","PaymentConfirmComponent_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","PaymentConfirmComponent_Template_form_ngSubmit_2_listener","ɵɵelement","ɵɵadvance","ɵɵproperty"],"sources":["C:\\projects\\cybersource_sa_angular\\cybersource_sa\\src\\app\\payment-confirm\\payment-confirm.component.ts","C:\\projects\\cybersource_sa_angular\\cybersource_sa\\src\\app\\payment-confirm\\payment-confirm.component.html"],"sourcesContent":["import { Component } from '@angular/core';\nimport { environment } from 'src/environments/environment';\nimport * as CryptoJS from 'crypto-js';\nimport { FormBuilder } from '@angular/forms';\n\n@Component({\n  selector: 'app-payment-confirm',\n  templateUrl: './payment-confirm.component.html',\n  styleUrls: ['./payment-confirm.component.scss']\n})\nexport class PaymentConfirmComponent {\n  paymentForm = document.getElementById('payment_form') as HTMLFormElement;\n  accessKey = 'c66502af927a3533bfa6d215394eda4c';\n  profileId = 'B63C4A44-D1AE-4F14-B0D5-4FFC7813736F';\n  transactionUuid = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);\n  signedFieldNames = 'access_key,profile_id,transaction_uuid,signed_field_names,unsigned_field_names,signed_date_time,locale,transaction_type,reference_number,amount,currency';\n  signedDateTime = new Date();\n  locale = 'en-US';\n  checkoutForm = this.formBuilder.group({\n    accessKey: 'c66502af927a3533bfa6d215394eda4c',\n    profileId: 'B63C4A44-D1AE-4F14-B0D5-4FFC7813736F',\n    transactionUuid: Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15),\n    signedFieldNames: 'access_key,profile_id,transaction_uuid,signed_field_names,unsigned_field_names,signed_date_time,locale,transaction_type,reference_number,amount,currency',\n    signedDateTime:  new Date(),\n    locale:  'en-US',\n    transaction_type: 'authorization',\n    amount: '25',\n    reference_number: '123456789'\n  });\n\n  constructor(    \n    private formBuilder: FormBuilder\n  ) {}\n\n  onSubmit(): void {      \n      console.warn('Your order has been submitted', this.checkoutForm.value);\n      this.checkoutForm.reset();\n  }\n\n  public sign(params: any): string {\n      console.log(params);\n      return this.signData(this.buildDataToSign(params), environment.SECRET_KEY);\n  }\n\n  public signData(data: string, secretKey: string): string {\n      const signature = CryptoJS.HmacSHA256(environment.HMAC_SHA256, secretKey);\n      const signatureBase = signature.toString(CryptoJS.enc.Base64);\n      console.log(signatureBase);\n      return signatureBase;\n  }\n\n  public buildDataToSign(params: any): string {\n      const signedFieldNames = params.signed_field_names.split(',');\n      const dataToSign = signedFieldNames.map((field: string) => `${field}=${params[field]}`);\n      console.log('!!!!!!!!!!!');\n      console.log(this.commaSeparate(dataToSign));\n      return this.commaSeparate(dataToSign);\n  }\n\n  public commaSeparate(dataToSign: string[]): string {\n      return dataToSign.join(',');\n  }\n}\n","<p>Payment Details</p>\n\n\n<form [formGroup]=\"checkoutForm\" (ngSubmit)=\"onSubmit()\">\n    <input type=\"hidden\" formControlName=\"access_key\">\n    <input type=\"hidden\" formControlName=\"profile_id\">\n    <input type=\"hidden\" formControlName=\"transaction_uuid\">\n    <input type=\"hidden\" formControlName=\"signed_field_names\">\n    <input type=\"hidden\" formControlName=\"unsigned_field_names\" value=\"\">\n    <input type=\"hidden\" formControlName=\"signed_date_time\">\n    <input type=\"hidden\" formControlName=\"locale\">\n    <div>\n      <label for=\"transaction_type\">\n        transaction_type\n      </label>\n      <input id=\"transaction_type\" type=\"text\" formControlName=\"transaction_type\">\n    </div>\n  \n    <div>\n      <label for=\"amount\">\n        amount\n      </label>\n      <input id=\"amount\" type=\"text\" formControlName=\"amount\">\n    </div>\n  \n    <div>\n        <label for=\"reference_number\">\n            reference_number\n        </label>\n        <input id=\"reference_number\" type=\"text\" formControlName=\"reference_number\">\n    </div>\n    <button class=\"button\" type=\"submit\">Purchase</button>\n  \n  </form>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}